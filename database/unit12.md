## 정규화(Normalization)

**정규화**는 관계형 데이터베이스 설계에서 **데이터의 중복을 최소화**하고 **이상 현상을 제거**하기 위해 테이블을 분해하는 과정이다. **함수적 종속 관계**를 분석하여 단계적으로 정규형을 만족하도록 테이블 구조를 개선한다.

<br>

### 1. 이상 현상(Anomaly)

**이상 현상**은 테이블 내 데이터 중복으로 인해 **삽입**/**갱신**/**삭제** 연산 시 발생하는 부작용이다.

<br>

**삽입 이상(Insertion Anomaly)**

- 데이터를 삽입하기 위해 **불필요한 데이터도 함께 삽입**해야 하는 문제
- 예시: 이벤트에 참여하지 않은 고객은 테이블에 등록할 수 없음

<br>

**갱신 이상(Update Anomaly)**

- 중복된 튜플 중 **일부만 변경**하여 데이터가 불일치하게 되는 문제
- 예시: 같은 고객의 등급을 일부 레코드만 변경하면 데이터 불일치 발생

<br>

**삭제 이상(Deletion Anomaly)**

- 튜플을 삭제하면 **필요한 데이터까지 함께 삭제**되는 데이터 손실 문제
- 예시: 마지막 이벤트 참여 기록을 삭제하면 고객 정보까지 삭제됨

<br>

### 2. 함수적 종속(Functional Dependency)

**함수적 종속**은 속성 간의 의존 관계를 나타낸다. **X → Y**는 속성 X의 값이 결정되면 속성 Y의 값이 유일하게 결정됨을 의미한다.

<br>

**완전 함수적 종속(Full Functional Dependency)**

- 기본키 **전체**에 종속되는 경우
- 예시: (학생번호, 과목코드) → 성적
- 학생번호와 과목코드가 **모두 있어야** 성적이 결정됨

<br>

**부분 함수적 종속(Partial Functional Dependency)**

- 기본키의 **일부**에만 종속되는 경우
- 예시: (학생번호, 과목코드) → 학생이름
- 학생번호**만으로** 학생이름이 결정됨

<br>

**이행적 함수적 종속(Transitive Functional Dependency)**

- **X → Y**, **Y → Z**가 성립할 때 **X → Z**가 성립되는 경우
- 예시: 학생번호 → 강좌이름, 강좌이름 → 수강료이면 학생번호 → 수강료

<br>

### 3. 제 1 정규화(1NF)

테이블의 모든 속성이 **원자값**(Atomic Value)을 갖도록 테이블을 분해하는 것이다.

<br>

**조건**

- 각 컬럼이 **하나의 값**만 가져야 함
- 하나의 컬럼은 **같은 타입**의 값을 가져야 함
- 각 컬럼이 **유일한 이름**을 가져야 함
- 컬럼의 **순서가 상관없어야** 함

<br>

**예시**

**정규화 전**

| 이름   | 나이 | 수강과목     |
| ------ | ---- | ------------ |
| 홍길동 | 20   | C, C++       |
| 이순신 | 21   | Java         |
| 이산   | 22   | DB, 운영체제 |

<br>

**정규화 후**

| 이름   | 나이 | 수강과목 |
| ------ | ---- | -------- |
| 홍길동 | 20   | C        |
| 홍길동 | 20   | C++      |
| 이순신 | 21   | Java     |
| 이산   | 22   | DB       |
| 이산   | 22   | 운영체제 |

<br>

### 4. 제 2 정규화(2NF)

제 1 정규화를 만족하고, **부분 함수적 종속**을 제거하여 **완전 함수적 종속**을 만족하도록 테이블을 분해하는 것이다.

<br>

**조건**

- 제 1 정규화를 만족해야 함
- 모든 속성이 기본키에 **완전 함수적 종속**이어야 함
- 기본키의 **부분집합이 결정자가 되어서는 안 됨**

<br>

**예시**

**정규화 전**

**기본키: (학생이름, 수강과목)**

| 학생이름 | 수강과목 | 나이 |
| -------- | -------- | ---- |
| 홍길동   | C        | 20   |
| 홍길동   | C++      | 20   |
| 이순신   | Java     | 21   |
| 이산     | DB       | 22   |
| 이산     | 운영체제 | 22   |

<br>

**정규화 후**

**학생 테이블**

| 학생이름 | 나이 |
| -------- | ---- |
| 홍길동   | 20   |
| 이순신   | 21   |
| 이산     | 22   |

<br>

**수강 테이블**

| 학생이름 | 수강과목 |
| -------- | -------- |
| 홍길동   | C        |
| 홍길동   | C++      |
| 이순신   | Java     |
| 이산     | DB       |
| 이산     | 운영체제 |

<br>

### 5. 제 3 정규화(3NF)

제 2 정규화를 만족하고, **이행적 함수적 종속**을 제거하도록 테이블을 분해하는 것이다.

<br>

**조건**

- 제 2 정규화를 만족해야 함
- 기본키를 제외한 속성들 간의 **이행적 종속성**이 없어야 함
- **기본키가 아닌 속성**이 다른 **기본키가 아닌 속성**을 결정하면 안 됨

<br>

**예시**

**정규화 전**

| 학생번호 | 강좌이름 | 수강료 | 성적 |
| -------- | -------- | ------ | ---- |
| 100      | 자바     | 10000  | A    |
| 200      | C++      | 15000  | B    |
| 300      | 자바     | 10000  | A    |

<br>

**함수 종속성**

- 학생번호 → 강좌이름
- 강좌이름 → 수강료
- 학생번호 → 수강료 (이행적 종속)

<br>

**정규화 후**

**학생강좌 테이블**

| 학생번호 | 강좌이름 | 성적 |
| -------- | -------- | ---- |
| 100      | 자바     | A    |
| 200      | C++      | B    |
| 300      | 자바     | A    |

<br>

**강좌 테이블**

| 강좌이름 | 수강료 |
| -------- | ------ |
| 자바     | 10000  |
| C++      | 15000  |

<br>

### 6. BCNF(Boyce-Codd Normal Form)

제 3 정규화를 만족하고, **모든 결정자가 후보키**가 되도록 테이블을 분해하는 것이다. 제 3 정규화에서 해결할 수 없는 이상 현상을 해결할 수 있다.

<br>

**조건**

- 제 3 정규화를 만족해야 함
- 모든 **결정자**가 **후보키 집합**에 속해야 함

<br>

**예시**

**정규화 전**

**기본키: (학생번호, 특강이름)**

| 학생번호 | 특강이름 | 교수   |
| -------- | -------- | ------ |
| 100      | 알고리즘 | 김교수 |
| 200      | 자료구조 | 이교수 |
| 300      | 알고리즘 | 김교수 |

<br>

**함수 종속성**

- 학생번호, 특강이름 → 교수
- 교수 → 특강이름 (교수가 결정자지만 후보키가 아님)

<br>

**정규화 후**

**수강 테이블**

| 학생번호 | 교수   |
| -------- | ------ |
| 100      | 김교수 |
| 200      | 이교수 |
| 300      | 김교수 |

<br>

**교수특강 테이블**

| 교수   | 특강이름 |
| ------ | -------- |
| 김교수 | 알고리즘 |
| 이교수 | 자료구조 |

<br>

### 7. 정규화의 장단점

**장점**

- 데이터 중복을 최소화하여 **저장 공간 절약**
- 데이터 **무결성**과 **일관성** 유지
- **이상 현상** 제거
- 데이터 **변경 시 영향 최소화**

<br>

**단점**

- 테이블 **분해로 인한 JOIN 증가**
- **조회 성능 저하** 가능 (JOIN 비용)
- 설계가 복잡해질 수 있음

<br>

### 8. 역정규화(De-normalization)

성능 향상을 위해 **정규화된 테이블을 의도적으로 통합**하거나 **중복 데이터를 추가**하는 과정이다.

<br>

**사용 시기**

- **JOIN이 빈번**하여 성능 저하가 발생하는 경우
- **집계 연산**이 자주 수행되는 경우
- **조회 성능**이 우선시되는 경우

<br>

**방법**

- 테이블 통합
- 계산된 컬럼 추가
- 테이블 수직/수평 분할
- 중복 컬럼 추가
